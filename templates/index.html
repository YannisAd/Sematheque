{#
    Page d'accueil de l'application.

    Cette page sert de point d'entrée et de tableau de bord. Elle est conçue de manière générique
    pour s'adapter aux données configurées dans l'application sans codage en dur.

    Variables contextuelles attendues :
    - project_info (dict) : Contient 'name', 'description' et métadonnées du projet.
    - global_available_types (list) : Liste des classes/types de ressources disponibles (uri, label).
#}

{% extends "layout.html" %}

{% block title %}Accueil - {{ project_info.name }}{% endblock %}

{% block content %}

<div class="hero-section py-5 mb-5">
    <div class="container">
        <div class="row justify-content-center text-center">
            <div class="col-lg-8">
                <h1 class="hero-title mb-3">Bienvenue sur {{ project_info.name }}</h1>
                <p class="hero-subtitle mb-4">
                    {{ project_info.description | default("Explorateur sémantique de données liées et visualisation de graphes de connaissances.") }}
                </p>
                
                <div class="main-actions">
                    <a href="{{ url_for('explore') }}" class="btn btn-primary btn-lg me-3 mb-2">
                        <i class="fas fa-compass me-2"></i> Explorer
                    </a>
                    <a href="{{ url_for('search') }}" class="btn btn-outline-primary btn-lg mb-2">
                        <i class="fas fa-search me-2"></i> Rechercher
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container mb-5">
    <div class="row justify-content-center mb-4">
        <div class="col-lg-8 text-center">
            <h2 class="section-title mb-3">Ressources disponibles</h2>
            <p class="text-muted">Parcourez les différentes catégories de données présentes dans la base.</p>
        </div>
    </div>
    
    <div class="carousel-container">
        <div class="carousel-wrapper">
            <div class="carousel-track" id="carouselTrack">
                {% if global_available_types %}
                    {# Définition des listes pour le cycle visuel #}
                    {% set icons_list = ['fa-cube', 'fa-layer-group', 'fa-database', 'fa-shapes', 'fa-project-diagram'] %}
                    {% set colors_list = ['primary', 'success', 'warning', 'info', 'secondary', 'dark'] %}

                    {# On boucle deux fois pour assurer l'effet de défilement infini visuel #}
                    {% for i in range(2) %}
                        {% for type in global_available_types %}
                            {% set icon = icons_list[loop.index0 % icons_list|length] %}
                            {% set color_class = colors_list[loop.index0 % colors_list|length] %}
                            
                            <div class="carousel-card">
                                <div class="resource-card">
                                    <div class="card-icon mb-3">
                                        <i class="fas {{ icon }} fa-3x text-{{ color_class }}"></i>
                                    </div>
                                    <h3 class="card-title">{{ type.label }}</h3>
                                    <p class="card-number text-muted">Voir les données</p>
                                    
                                    <form action="{{ url_for('parcours') }}" method="POST" class="d-grid">
                                        <input type="hidden" name="resource_type" value="{{ type.label }}">
                                        <button type="submit" class="btn btn-{{ color_class }} w-100">Explorer</button>
                                    </form>
                                </div>
                            </div>
                        {% endfor %}
                    {% endfor %}
                {% else %}
                    <div class="col-12 text-center py-5">
                        <p class="text-muted">Aucune classe de ressource détectée dans la configuration.</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="tools-section py-4 bg-light">
    <div class="container">
        <div class="row justify-content-center mb-4">
            <div class="col-lg-8 text-center">
                <h2 class="section-title mb-3">Boîte à outils</h2>
            </div>
        </div>
        
        <div class="row g-3 justify-content-center">
            <div class="col-6 col-md-3">
                <a href="{{ url_for('ontology_view') }}" class="tool-link">
                    <div class="tool-card">
                        <i class="fas fa-project-diagram fa-2x text-info mb-2"></i>
                        <h4 class="tool-title">Ontologie</h4>
                    </div>
                </a>
            </div>
            
            <div class="col-6 col-md-3">
                <a href="{{ url_for('explore') }}" class="tool-link">
                    <div class="tool-card">
                        <i class="fas fa-filter fa-2x text-secondary mb-2"></i>
                        <h4 class="tool-title">Exploration</h4>
                    </div>
                </a>
            </div>

            <div class="col-6 col-md-3">
                <a href="{{ url_for('parcours') }}" class="tool-link">
                    <div class="tool-card">
                        <i class="fas fa-route fa-2x text-warning mb-2"></i>
                        <h4 class="tool-title">Parcours Graphe</h4>
                    </div>
                </a>
            </div>
        </div>
    </div>
</div>

<style>
    /** Styles spécifiques à la page d'accueil (Hero, Carousel). */
    
    .hero-section { background: linear-gradient(135deg, rgba(31, 119, 180, 0.05) 0%, rgba(255, 127, 14, 0.02) 100%); }
    .hero-title { font-size: 2.5rem; font-weight: 400; color: #2c3e50; margin-bottom: 1rem; }
    .hero-subtitle { font-size: 1.2rem; color: #6c757d; max-width: 700px; margin: 0 auto 2rem; }
    
    .main-actions .btn { padding: 12px 24px; font-size: 1.1rem; transition: all 0.3s ease; }
    .main-actions .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    
    .section-title { font-size: 2rem; font-weight: 500; color: #2c3e50; }
    
    /* Carousel */
    .carousel-container { position: relative; overflow: hidden; padding: 0 20px; }
    .carousel-wrapper { overflow: hidden; border-radius: 12px; }
    .carousel-track { display: flex; animation: slideCarousel 20s infinite linear; gap: 1.5rem; }
    .carousel-card { flex: 0 0 300px; min-width: 300px; }
    .carousel-track:hover { animation-play-state: paused; }
    
    @keyframes slideCarousel {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); } /* Défilement continu sur la moitié (données dupliquées) */
    }
    
    /* Cartes */
    .resource-card { 
        background: white; padding: 2rem 1.5rem; border-radius: 12px; 
        box-shadow: 0 2px 12px rgba(0,0,0,0.08); text-align: center; height: 280px; 
        display: flex; flex-direction: column; justify-content: space-between; 
        transition: all 0.3s ease; border: 1px solid #f1f3f4; 
    }
    .resource-card:hover { transform: translateY(-4px); box-shadow: 0 8px 25px rgba(0,0,0,0.15); }
    .resource-card .card-title { font-size: 1.2rem; font-weight: 600; color: #2c3e50; margin: 0.5rem 0; text-transform: capitalize; }
    .resource-card .card-number { color: #6c757d; font-size: 0.95rem; margin-bottom: 1.5rem; }
    
    .tool-link { text-decoration: none; color: inherit; }
    .tool-link:hover { color: inherit; text-decoration: none; }
    .tool-card { 
        background: white; padding: 1.5rem; border-radius: 8px; 
        box-shadow: 0 2px 8px rgba(0,0,0,0.06); text-align: center; 
        transition: all 0.3s ease; border: 1px solid #f1f3f4; height: 120px; 
        display: flex; flex-direction: column; justify-content: center; align-items: center; 
    }
    .tool-card:hover { transform: translateY(-3px); box-shadow: 0 6px 20px rgba(0,0,0,0.12); border-color: #dee2e6; }
    .tool-title { font-size: 1rem; font-weight: 600; color: #2c3e50; margin: 0; }
    
    .btn { border-radius: 6px; font-weight: 500; transition: all 0.3s ease; border-width: 1px; }
    .btn:focus, .tool-card:focus { box-shadow: 0 0 0 3px rgba(31, 119, 180, 0.25); outline: none; }

    @media (max-width: 768px) {
        .hero-title { font-size: 2rem; }
        .hero-subtitle { font-size: 1.1rem; }
        .main-actions .btn { display: block; width: 100%; margin-bottom: 0.5rem; }
        .carousel-card { flex: 0 0 260px; min-width: 260px; }
    }
</style>
{% endblock %}